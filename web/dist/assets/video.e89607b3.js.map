{"version":3,"file":"video.e89607b3.js","sources":["../../src/views/video/video.vue"],"sourcesContent":["<!--点进video显示的页面-->\r\n<template>\r\n    <div class=\"main-box\">\r\n\t\t<Headers @go=\"goHeader\" :nosearch=\"true\" :nocollect=\"true\"></Headers>\r\n        <VH-Dialog v-if=\"showDlialog\" @close=\"showDlialog=false\">\r\n\t\t\t<VH-Infomation v-if=\"dialogBox==1\"></VH-Infomation>\r\n\t\t\t<VH-Upload v-if=\"dialogBox==2\"></VH-Upload>\r\n\t\t</VH-Dialog>\r\n        <div class=\"video-box\">\r\n<!--            <video class=\"video\" :src=\"videoUrl\" type=\"video/mp4\" preload=\"auto\" controls=\"controls\"></video>-->\r\n            <video ref=\"videoPlayer\" class=\"video\" :src=\"videoUrl\" type=\"video/mp4\" preload=\"auto\" controls=\"controls\" @volumechange=\"saveVolume\"></video>\r\n\r\n\r\n            <div class=\"video-info\">\r\n                <p @mouseenter=\"showText=true\" @mouseleave=\"showText=false\" :class=\"showText ? 'video-title':'video-title hidde-tex'\">{{videoname}}</p>\r\n                <span v-if=\"relationId==0\" title=\"添加到收藏\" @click=\"addRelation\" class=\"collect iconfont icon-shoucang-shoucang\">收藏</span>\r\n                <span v-if=\"relationId!=0\" title=\"取消收藏\" @click=\"removeRelation\" class=\"iscollect iconfont icon-shoucang-shoucang\"><p>已收藏</p></span>\r\n            </div>\r\n        </div>\r\n        <AlertMsg ref=\"AlertMsg\"></AlertMsg>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport VHInfomation from '@/components/VH-Infomation/VH-Infomation.vue';\r\nimport VHUpload from '@/components/VH-Upload/VH-Upload.vue';\r\nimport config from '@/api/config';\r\nimport { postRequest } from '@/api';\r\nexport default {\r\n    name: 'vh-video',\r\n    components:{\r\n\t\tVHInfomation,\r\n\t\tVHUpload,\r\n\t},\r\n    data () {\r\n        return {\r\n            showText:false,\r\n            vid:null,\r\n            showDlialog:false,\r\n            dialogBox:1,\r\n            videoUrl:'',\r\n            videoData:null,\r\n            videoname:'',\r\n            relationId:0,\r\n        }\r\n    },\r\n    created() {\r\n        document.title ='StarSteam';\r\n        this.vid=this.$route.query.vid\r\n        this.videoUrl = config.baseUrl.url +'file/video/'+this.vid+'.mp4'\r\n        \r\n        console.log(this.videoUrl)\r\n\r\n        this.getVideoInfo()\r\n        this.getIsRelation()\r\n\r\n        this.$nextTick(() => {\r\n            const savedVolume = localStorage.getItem('videoVolume') || 0.5;  // 获取保存的音量，默认为0.5\r\n            if (this.$refs.videoPlayer) {\r\n                this.$refs.videoPlayer.volume = savedVolume;  // 设置初始音量\r\n                console.log(savedVolume)\r\n            }\r\n        });\r\n    },\r\n    methods:{\r\n        saveVolume() {\r\n            const currentVolume = this.$refs.videoPlayer.volume;\r\n            localStorage.setItem('videoVolume', currentVolume);  // 将音量保存到localStorage\r\n        },\r\n\r\n        goHeader(e){\r\n          if(e.where == 'info'){\r\n            this.dialogBox = 1\r\n            this.showDlialog=true\r\n          }else if(e.where == 'upload'){\r\n            this.dialogBox = 2\r\n            this.showDlialog=true\r\n          }else if(e.where == 'loginout'){\r\n            console.log(\"退出\")\r\n          }\r\n\t\t    },\r\n        getVideoInfo(){\r\n            let json ={ 'vid': parseInt(this.vid) }\r\n            postRequest('/watch/find',json).then(res => {\r\n                this.videoData=res.data.list\r\n                this.videoname = this.videoData.detail\r\n                postRequest('/watch/plus',json).then(res => {\r\n                   \r\n                })\r\n            })\r\n        },\r\n        getIsRelation(){\r\n            let json ={ 'vid': parseInt(this.vid) }\r\n            postRequest('/relation/is',json).then(res => {\r\n                this.relationId=res.data.relation\r\n            })\r\n        },\r\n        addRelation(){\r\n            let json ={ 'vid': parseInt(this.vid) }\r\n            postRequest('/relation/add',json).then(res => {\r\n                this.relationId=res.data.relation\r\n                switch (res.code) {\r\n                    case 201:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            2,\"你已经收藏过该视频\")\r\n                        break\r\n                    case 202:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            2,\"在添加收藏时产生了未知的异常\"\r\n                        )\r\n                        break\r\n                    case 200:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            1,\"收藏视频成功\"\r\n                        )\r\n                        this.relationId = res.data.relation\r\n                        break\r\n                    default:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            2,\"未知错误：\"+res.msg\r\n                        )\r\n                }\r\n            })\r\n        },\r\n        removeRelation(){\r\n            let json ={ 'vid': parseInt(this.vid) }\r\n            postRequest('/relation/delete',json).then(res => {\r\n                 switch (res.code) {\r\n                    case 201:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            2,\"在删除收藏时产生了未知的异常\")\r\n                        break\r\n                    case 200:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            1,\"取消收藏视频成功\"\r\n                        )\r\n                        this.relationId = 0\r\n                        break\r\n                    default:\r\n                        this.$refs.AlertMsg.addMsg(\r\n                            2,\"未知错误：\"+res.msg\r\n                        )\r\n                }\r\n            })\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style  scoped>\r\n@import '@/assets/css/video.css';\r\n</style>\r\n"],"names":["_sfc_main","VHInfomation","VHUpload","config","savedVolume","currentVolume","e","json","postRequest","res","_hoisted_1","_hoisted_2","_hoisted_4","_hoisted_5","_withScopeId","_createElementVNode","_openBlock","_createElementBlock","_createVNode","_component_Headers","$options","$data","_createBlock","_component_VH_Dialog","_component_VH_Infomation","_component_VH_Upload","args","_component_AlertMsg"],"mappings":"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"}